<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>MiPerfil</title>
  <link rel="stylesheet" href="../CSS/style_user_profile_page.css">
  <script src="../JS/module_loader.js"></script>
  <script src="../JS/name_and_module_loader.js"></script>
</head>

<body>
  <header id="header_user_profile"></header>
  <div id="user_profile_name_card"><!--Nombre del perfil -->
  </div>
  <div class="user_profile_container">
    <div id="user_profile_button_group"></div>
    <div id="user_profile_container_cards">
      <!-- Aqui quiero poner los cards -->
    </div>
    <div id="user_profile_button1"></div>
  </div>

  <footer id="footer_user_profile"></footer>

  <script>
    document.addEventListener('DOMContentLoaded', init);
    function init(){
      module_loader("../HTML_Modules/header.html", "header_user_profile");
      module_loader("../HTML_Modules/footer.html","footer_user_profile");


      //Esto carga el nombre del usuario
      fetch("../HTML_Modules/elongated_card.html")
              .then((file) => {
                return file.text()
              }).then((text) => {
                document.getElementById("user_profile_name_card").innerHTML = text;

                fetch("../JSON_Files/users.json")
                        .then((file) => file.json())
                        .then((users) => {
                          const user = users.find(u => u.id === 1);
                          document.querySelector(".elongated_card_text").textContent = user.nombre + " " + user.apellidos;
                          document.querySelector(".elongated_card_image").src = user.foto;
                          document.querySelector(".elongated_card_image").alt = user.nombre + " " + user.apellidos;
                        })
              })

      //Esto carga la tarjeta de asignaturas
      fetch("../HTML_Modules/template_elongated_card.html")
              .then((file) => {//fichero HTML
                return file.text()
              })
              .then((text) => { //texto plano de HTML
                document.getElementById("user_profile_container_cards").innerHTML = text;

                const container = document.querySelector("#user_profile_container_cards");
                const templateCard = document.querySelector(".template_elongated_card");
                fetch("../JSON_Files/subjects.json")
                        .then((file) => file.json())
                        .then((subjects) => {
                          subjects.forEach((subject) => {
                            const card = templateCard.content.cloneNode(true);
                            card.querySelector(".template_elongated_card_text").textContent = subject.nombre;
                            card.querySelector(".template_elongated_card_image").src = subject.foto;
                            card.querySelector(".template_elongated_card_image").alt = subject.nombre;
                            container.appendChild(card);
                          });
                        })
                        .catch(error => console.error(error));
              })

      module_loader("../HTML_Modules/group_element.html","user_profile_button_group");
      module_loader("../HTML_Modules/button_element.html","user_profile_button1");

    }
  </script>

</body>
</html>